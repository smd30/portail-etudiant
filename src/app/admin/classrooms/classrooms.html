<!-- src/app/admin/classrooms/classrooms.html -->
<div class="content">
    <div class="container-fluid">
        
        <div class="card mb-4 p-3">
            <div class="row page-titles mx-0">
                <div class="col-sm-6 p-md-0">
                    <div class="welcome-text">
                        <h4>Liste des classes</h4>
                        <span class="ml-1">Gestion des classes</span>
                    </div>
                </div>
                <div class="col-sm-6 p-md-0 justify-content-sm-end mt-2 mt-sm-0 d-flex">
                    <button class="btn btn-primary" (click)="openAddModal()">+ Ajouter une classe</button>
                </div>
            </div>
        </div>
  
        <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>
  
        <div class="card">
            <div class="card-header"><h4 class="card-title">Liste des classes</h4></div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead class="thead-dark">
                            <tr class="table-active">
                                <th>ID</th>
                                <th>Libellé</th>
                                <th>Description</th>
                                <th>Cours associés</th>
                                <th class="text-right">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngIf="isLoading">
                                <td colspan="5" class="text-center">Chargement en cours...</td>
                            </tr>
                            <tr *ngFor="let classroom of classrooms">
                                <td>{{ classroom.id }}</td>
                                <td>{{ classroom.libelle }}</td>
                                <td>{{ classroom.description }}</td>
                                <td>
                                    <span *ngFor="let cour of classroom.cours" class="badge badge-info mr-1">
                                        {{ cour.libelle }}
                                    </span>
                                </td>
                                <td class="text-center">
                                    <div class="d-grid g-4 d-md-flex justify-content-md-end">
                                        <button class="btn btn-sm btn-warning text-white" (click)="openEditModal(classroom)">Modifier</button>
                                        &nbsp;&nbsp;&nbsp;
                                        <button class="btn btn-sm btn-danger" (click)="openDeleteModal(classroom)">Supprimer</button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
  
<!-- Modal pour ajouter/modifier une classe -->
<app-modal [isOpen]="isModalOpen" (close)="isModalOpen = false">
    <h5 class="modal-title">{{ selectedClassroom ? 'Modifier' : 'Ajouter' }} une classe</h5>
    
    <form (ngSubmit)="submitForm()">
        <div class="modal-body row g-3">
            <div class="col-md-12">
                <label class="form-label">Libellé</label>
                <input type="text" name="libelle" [(ngModel)]="formData.libelle" class="form-control" required>
            </div>
            <div class="col-md-12 mt-3">
                <label class="form-label">Description</label>
                <textarea name="description" [(ngModel)]="formData.description" class="form-control" required></textarea>
            </div>
            <div class="col-md-12 mt-3">
                <label class="form-label">Cours associés</label>
                <select class="form-control" multiple [(ngModel)]="selectedCours" name="cours">
                    <option *ngFor="let cour of cours" [value]="cour.id">{{ cour.libelle }}</option>
                </select>
                <small class="text-muted">Maintenez Ctrl (Windows) ou Cmd (Mac) pour sélectionner plusieurs cours</small>
            </div>
        </div>
        
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" (click)="isModalOpen = false">Annuler</button>
            <button type="submit" class="btn btn-primary" [disabled]="isLoading">
                {{ isLoading ? 'Enregistrement...' : 'Enregistrer' }}
            </button>
        </div>
    </form>
</app-modal>
  
<!-- Modal de confirmation de suppression -->
<app-confirm-modal 
    [isOpen]="isDeleteModalOpen" 
    (confirm)="deleteClassroom()" 
    (cancel)="isDeleteModalOpen = false">
    <p>Êtes-vous sûr de vouloir supprimer cette classe ?</p>
</app-confirm-modal>